<!DOCTYPE html>
<html lang="en"><head>
<script src="mdag2025p2_files/libs/clipboard/clipboard.min.js"></script>
<script src="mdag2025p2_files/libs/quarto-html/tabby.min.js"></script>
<script src="mdag2025p2_files/libs/quarto-html/popper.min.js"></script>
<script src="mdag2025p2_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="mdag2025p2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="mdag2025p2_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="mdag2025p2_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.32">

  <meta name="author" content="Sean van der Merwe, Johan√© Nienkemper-Swanepoel, Raeesa Ganey">
  <title>Beyond multivariate applications: Quarto for reproducible interactive documents</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="mdag2025p2_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="mdag2025p2_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="mdag2025p2_files/libs/revealjs/dist/theme/quarto-ea4028563d6736442aa31df15ee98123.css">
  <link href="mdag2025p2_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="mdag2025p2_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="mdag2025p2_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="mdag2025p2_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="mdag2025p2_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="mdag2025p2_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="mdag2025p2_files/libs/quarto-diagram/mermaid.min.js"></script>
  <script src="mdag2025p2_files/libs/quarto-diagram/mermaid-init.js"></script>
  <link href="mdag2025p2_files/libs/quarto-diagram/mermaid.css" rel="stylesheet">
  <script src="mdag2025p2_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

  <script src="mdag2025p2_files/libs/pymjs-1.3.2/pym.v1.js"></script>

  <script src="mdag2025p2_files/libs/widgetframe-binding-0.3.1/widgetframe.js"></script>

</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Beyond multivariate applications: Quarto for reproducible interactive documents</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Sean van der Merwe, Johan√© Nienkemper-Swanepoel, Raeesa Ganey 
</div>
</div>
</div>

</section>
<section id="introduction" class="title-slide slide level1 center">
<h1>Introduction</h1>
<p>For the second part of the workshop:</p>
<ul>
<li>Details matter, so ask questions immediately if you don‚Äôt follow</li>
<li>No, you don‚Äôt have to remember everything, you can refer back to these slides, but the more key concepts you remember the better</li>
</ul>
<p>You can access Part 1 of the slides at <em>seanvdm.co.za/mdag2025</em> and on the last slide of Part 1 you will find a link to all the resources for the day, <em>including Part 2</em>.</p>
</section>

<section>
<section id="part-2---details" class="title-slide slide level1 center">
<h1>Part 2 - Details</h1>
<p>How do you get this power for yourself?</p>
<p>Should you even try to get this power? Isn‚Äôt is dangerous?</p>
</section>
<section id="what-are-the-downsides-to-interactive-materials" class="slide level2">
<h2>What are the downsides to interactive materials?</h2>
<p>The biggest downsides are obvious when you try to distribute it:</p>
<ul>
<li>Interactive materials are great for slow exploration, not for scanning</li>
<li>It is not immediately obvious what the author wants to convey</li>
<li>It allows for the audience to draw their own meaning and interpretation
<ul>
<li><strong>Requires that the recipient understands that they are meant to interact with it</strong></li>
</ul></li>
<li>More difficult to email or send, but not impossible
<ul>
<li>Interactive formats are designed to be hosted, not distributed</li>
</ul></li>
</ul>
</section>
<section id="static-formats" class="slide level2 smaller">
<h2>Static Formats</h2>
<ul>
<li>Microsoft Word (.docx) and PowerPoint (.pptx)
<ul>
<li>Used in industry in most of the world</li>
<li>A lot of precise control (often a bad thing)</li>
<li>Great for quickly creating short documents with precise formatting, like business letters, position statements, and <em>assignments</em></li>
<li>For longer documents the use of styles is essential to avoid a mess</li>
<li>Alternatives include OnlyOffice, LibreOffice, Google Docs</li>
</ul></li>
<li>Portable Document Format (.pdf)
<ul>
<li>Extremely precise control of everything</li>
<li>It has no concept of paragraphs, it‚Äôs just letters, lines, and pictures</li>
<li>Do not create documents in this format, only convert and manipulate</li>
</ul></li>
</ul>
</section>
<section id="interoperability" class="slide level2">
<h2>Interoperability</h2>
<p>PDF and HTML are absorbing states, Word nearly so.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="htmlwidget-47dd9a938ef8834be97f" style="width:100%;height:614.4px;" class="widgetframe html-widget"></div>
<script type="application/json" data-for="htmlwidget-47dd9a938ef8834be97f">{"x":{"url":"mdag2025p2_files/figure-revealjs//widgets/widget_unnamed-chunk-2.html","options":{"xdomain":"*","allowfullscreen":false,"lazyload":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section></section>
<section>
<section id="what-powers-all-the-flashiness" class="title-slide slide level1 center">
<h1>What powers all the flashiness?</h1>
<p>The interactivity is brought to you (under the hood) by JavaScript. You do not see it - it is very well hidden, but it is working in the background to display the figures and react to your inputs.</p>
<p>The JavaScript accompanies (or is embedded in) HTML. No, you do not need to know any HTML at all, just like you don‚Äôt need to know that a .docx is actually a .zip containing .xml files.</p>
<p>All you need to learn is <em>Markdown</em> and a little of your favourite scripting language (<em>e.g.&nbsp;R</em>).</p>
</section>
<section id="markdown" class="slide level2">
<h2>Markdown</h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Markdown">Markdown</a> is the new (2004) language of the technical internet
<ul>
<li>Places like GitHub, Reddit, StackExchange have supported it for a decade</li>
</ul></li>
<li>It is deliberately simple and easy to use
<ul>
<li><strong>You type what you mean and let the interpreter do the formatting</strong></li>
<li>It is made to be readable without needing to be converted or formatted</li>
</ul></li>
<li>GAI Chatbots write in Markdown!</li>
</ul>
</section>
<section id="technicalities-shouldnt-matter" class="slide level2">
<h2>Technicalities shouldn‚Äôt matter</h2>
<ul>
<li>The literate programming principle (made popular by Donald Knuth in the 90s via LaTeX) suggests that it is faster and easier to just type what you mean rather than fret over every detail</li>
<li>ChatGPT doesn‚Äôt understand the difference between a table and a code block, or a heading and a bold statement
<ul>
<li><strong>it is just generating text</strong></li>
<li>Yet you see neatly formatted output!</li>
<li>This is one area where you can really learn from AI: it doesn‚Äôt touch the mouse to create math and neither should you</li>
</ul></li>
<li>Doing things manually wastes so much of your time</li>
</ul>
</section>
<section id="my-workflow" class="slide level2 smaller">
<h2>My workflow</h2>
<blockquote>
<p>I do almost all my work directly in markdown</p>
</blockquote>
<ul>
<li>For consultation clients who use Word I give explanations, references or links, math (e.g.&nbsp;model definitions), code (optional), results (tables and figures), interpretation, and sometimes statistical conclusions by just typing text in one text file
<ul>
<li>I then press a button and get a perfectly formatted Word report with structure, table of contents, etc.</li>
</ul></li>
<li>For research I do the same, but choose the PDF option to get both a neat PDF and raw LaTeX + figure files</li>
<li>For teaching I create all my assessments via markdown, including assignments, tests, quizzes, etc.
<ul>
<li>In class I type in markdown to explain concepts live and demonstrate principles</li>
</ul></li>
<li>As department head I write letters and implement processes via markdown</li>
</ul>
</section>
<section id="lets-learn-markdown-quickly" class="slide level2">
<h2>Let‚Äôs learn markdown quickly</h2>
<ul>
<li>Hashes make headings, 1 for a 1st level heading, 4 for 4th level, etc.
<ul>
<li><code># This is a big heading</code>, <code>## This is a smaller heading</code>, <code>###### This is a tiny heading</code></li>
<li><code># This is a section slide heading</code>, <code>## This is a normal slide heading</code></li>
</ul></li>
<li><code>&lt;https://www.this_is_a_link.com&gt;</code>, <code>*This is italics*</code>, <code>**This is bold**</code>
<ul>
<li><code>[This is a fancier link](https://pointing.to.this/)</code></li>
</ul></li>
<li><code>&gt;</code> starts a quote, <code>-</code> creates a bullet, and numbered lists are just <code>1.</code>
<ul>
<li>See <a href="https://quarto.org/docs/authoring/markdown-basics.html" class="uri">https://quarto.org/docs/authoring/markdown-basics.html</a> for more</li>
</ul></li>
</ul>
</section>
<section id="other-easy-things-you-can-do-without-code" class="slide level2">
<h2>Other easy things you can do without code</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="border">
<p>Text with borders, perhaps in columns</p>
</div>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>A note</p>
</div>
</div>
</div>
</div><div class="column" style="width:40%;">
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p>or a warning, <mark>perhaps with a highlight</mark></p>
</div>
</div>
</div>
</div></div>
</section>
<section id="static-diagrams" class="slide level2">
<h2>Static diagrams</h2>
<p>Interactive diagrams are fun, but require detailed specification. Simple diagrams can be done really fast with just basic labels:</p>
<div class="cell" data-reveal="true" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class=""><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
    A{Is Y continuous?} --&gt;|No| B(Table)
    A --&gt;|Yes| C{Is X1 continuous?}
    C --&gt;|No| D[Box plot]
    C --&gt;|Yes| E[Scatter plot]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href=""></a>flowchart LR</span>
<span id="cb1-2"><a href=""></a>    A{Is Y continuous?} <span class="sc">-</span><span class="ot">-&gt;</span><span class="er">|</span>No<span class="sc">|</span> <span class="fu">B</span>(Table)</span>
<span id="cb1-3"><a href=""></a>    A <span class="sc">-</span><span class="ot">-&gt;</span><span class="er">|</span>Yes<span class="sc">|</span> C{Is X1 continuous?}</span>
<span id="cb1-4"><a href=""></a>    C <span class="sc">-</span><span class="ot">-&gt;</span><span class="er">|</span>No<span class="sc">|</span> D[Box plot]</span>
<span id="cb1-5"><a href=""></a>    C <span class="sc">-</span><span class="ot">-&gt;</span><span class="er">|</span>Yes<span class="sc">|</span> E[Scatter plot]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="what-about-code" class="slide level2">
<h2>What about code</h2>
<ul>
<li>Code blocks start and end with 3 backticks, such as <code>```{language options} some code ```</code></li>
<li>‚Äúlanguage‚Äù and ‚Äúoptions‚Äù depend on the interpreter</li>
</ul>
<p>Quarto supports a lot of languages but I typically use R, Stan, CSS, and HTML only for my work.</p>
<ul>
<li>The most powerful option (use carefully) is ‚Äúresults: asis‚Äù
<ul>
<li>which tells Quarto to process the <em>output</em> of the R code chunk as if it was part of the markdown document</li>
<li>This lets you create many pages of document from a single code block!</li>
</ul></li>
</ul>
</section>
<section id="technicalities-that-matter" class="slide level2">
<h2>Technicalities that matter</h2>
<ul>
<li>There are not many technicalities - it typically just works</li>
<li>I could turn this presentation into a regular web page by only changing a few words here and there
<ul>
<li>A few more small changes and most of the presentation could be a Word document (or PowerPoint or Beamer)
<ul>
<li>I‚Äôd lose the interactivity though</li>
</ul></li>
</ul></li>
<li>The more detail oriented you are the more small technicalities you will come across, most are easy to address though
<ul>
<li>Here‚Äôs the most important issue in my view:</li>
</ul></li>
</ul>
<p><a href="pdfexample.pdf">Let‚Äôs talk graphics formats - click here.</a></p>
</section></section>
<section>
<section id="graphics-formats" class="title-slide slide level1 center">
<h1>Graphics formats</h1>
<p>Every target format has ideal graphics formats for plots.</p>
</section>
<section id="word-or-powerpoint" class="slide level2">
<h2>Word or PowerPoint</h2>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>My recommendation</strong></p>
</div>
<div class="callout-content">
<p><strong>Enhanced Metafile (.emf)</strong></p>
<p>Catch: Requires the <em>devEMF</em> library, e.g.</p>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href=""></a><span class="fu">library</span>(devEMF)</span>
<span id="cb2-2"><a href=""></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">dev=</span><span class="st">'emf'</span>, <span class="at">fig.ext=</span><span class="st">'emf'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can try the <strong>Windows Metafile (.wmf)</strong> format instead, which is built into R. It usually works but is buggy sometimes.</p>
<p>Or you can use <strong>Scalable Vector Graphics (.svg)</strong> which works great in Office 365 Desktop.</p>
</section>
<section id="pdf-latex-based" class="slide level2">
<h2>PDF (LaTeX based)</h2>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>My recommendation</strong></p>
</div>
<div class="callout-content">
<p><strong>Portable Document Format (.pdf)</strong></p>
<p>Catch: only works with PDF rendering</p>
</div>
</div>
</div>
<p>Or you can use <strong>Scalable Vector Graphics (.svg)</strong> which works in theory but might be buggy in practice depending on your editor and packages.</p>
</section>
<section id="revealjs-or-other-html-based-formats" class="slide level2">
<h2>RevealJS or other HTML based formats</h2>
<blockquote>
<p>For all static plots, e.g.&nbsp;base plot, ggplot2, biplotEZ, ‚Ä¶, use <strong>Scalable Vector Graphics (.svg)</strong> for the highest quality and smallest file size</p>
</blockquote>
<ul>
<li>For interactive graphics you must use a <strong>JavaScript (JS)</strong> based format
<ul>
<li>Other formats can have animations, but they are not really interactive</li>
</ul></li>
<li>JavaScript only works in HTML based formats, rendering in a browser (any)
<ul>
<li>The script tells the browser what to do when your mouse interacts with the plot</li>
</ul></li>
<li>You <strong>don‚Äôt</strong> need to learn any JS, you just use an R library</li>
</ul>
</section>
<section id="js-graphics-options" class="slide level2">
<h2>JS graphics options</h2>
<ul>
<li>There any many JS graphics tools
<ul>
<li>Most are for Python. If you know Python you‚Äôve probably heard of them already so I will skip</li>
<li>There are two that I‚Äôd like to mention: <em>plotly</em> and <em>echarts4r</em></li>
</ul></li>
</ul>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Plotly</strong></p>
</div>
<div class="callout-content">
<p>Plotly is the most popular, most powerful, and easiest to use by far. <strong>BUT</strong> the R package is no longer maintained and the R help files are on their way out üò¢</p>
</div>
</div>
</div>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Echarts4r</strong></p>
</div>
<div class="callout-content">
<p>Echarts4r is new and maintained, but more difficult to use and limited in scope.</p>
</div>
</div>
</div>
</section>
<section id="to-be-continued" class="slide level2">
<h2>To be continued ‚Ä¶</h2>
<p>In Part 3 we will work through the steps of:</p>
<ul>
<li>Creating HTML based Quarto documents or presentations, specifically with <strong>RevealJS</strong></li>
<li>Adding plots, including multivariate plots like <strong>biplots</strong></li>
<li>Creating a nice static ggplot, then making it interactive with <strong>ggplotly</strong></li>
<li>Making an interactive 3D plot directly in <strong>plotly</strong></li>
<li>Making interactive plots in general using <strong>echarts4r</strong></li>
</ul>
</section></section>
<section>
<section id="bonus-writing-to-excel" class="title-slide slide level1 center">
<h1>Bonus: Writing to Excel</h1>
<p>In Part 1 we showed that we can play with data interactively on a slide for basic exploration. <strong>What if you need the audience/students to actually work with the data though?</strong></p>
<div class="callout callout-caution callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>What if you want to generate or prepare data for students?</strong></p>
</div>
<div class="callout-content">
<p>You might think, ‚ÄúLet me make it look nice manually by opening it in Excel,‚Äù but then you decide to generate new data and you have to repeat those steps, again and again, and then you‚Äôre going to ask yourself, ‚ÄúWhy didn‚Äôt I just make this part of the code?‚Äù</p>
</div>
</div>
</div>
</section>
<section id="writing-to-excel" class="slide level2">
<h2>Writing to Excel</h2>
<ul>
<li>When one does a large simulation study or extensive analysis, one often has to summarise the tables because they are just too large to fit on a page</li>
<li>Yet, most of the audience is familiar with spreadsheets, including filters, sorts, ‚Ä¶</li>
<li>Sometimes the best way to make your results interactive is to save it nicely in a spreadsheet</li>
</ul>
<p>R has several nice packages for this, the best of which are <em>openxlsx</em> and <em>openxlsx2</em>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href=""></a>mydata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Gender =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"M"</span>,<span class="st">"F"</span>), <span class="dv">100</span>, <span class="cn">TRUE</span>), <span class="at">Result =</span> <span class="fu">rbinom</span>(<span class="dv">100</span>, <span class="dv">100</span>, <span class="fl">0.7</span>))</span>
<span id="cb3-2"><a href=""></a><span class="fu">list</span>(<span class="at">SheetName =</span> mydata) <span class="sc">|&gt;</span> openxlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(<span class="st">"FileName.xlsx"</span>) <span class="co"># or just mydata |&gt; ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="statistics-assignments" class="slide level2 smaller">
<h2>Statistics assignments</h2>
<ul>
<li>Personally, I‚Äôve been using this approach for over a decade when creating assignments</li>
<li>I generate data sets that test the outcomes I am targeting in a controlled way</li>
<li>I add randomness so that each student gets different data (but similar results)
<ul>
<li>If the randomness is small then it is still easy to mark, say with a rubric</li>
<li>If the randomness is larger then you can then give the marker and students a parameterised Quarto document
<ul>
<li>This means that each student has a personalised memo, specially just for them üòä</li>
</ul></li>
</ul></li>
</ul>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>That‚Äôs right</strong></p>
</div>
<div class="callout-content">
<p><strong>Quarto documents can take inputs!</strong></p>
</div>
</div>
</div>
</section>
<section id="cycling-through-students" class="slide level2">
<h2>Cycling through students</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href=""></a>students <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'2024000001'</span>, <span class="st">'2024000002'</span>, <span class="st">'2024000003'</span>, <span class="st">'2024000004'</span>,</span>
<span id="cb4-2"><a href=""></a>              <span class="st">'2024000005'</span>) <span class="co"># Get class list in R somehow</span></span>
<span id="cb4-3"><a href=""></a><span class="co"># You can read student numbers from class list / mark list file:</span></span>
<span id="cb4-4"><a href=""></a><span class="co"># students &lt;- openxlsx::read.xlsx('mark_list.xlsx', startRow = 4)$Student.ID</span></span>
<span id="cb4-5"><a href=""></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb4-6"><a href=""></a>students <span class="sc">|&gt;</span> <span class="fu">lapply</span>(\(s) {   <span class="co"># Make a list of data frames</span></span>
<span id="cb4-7"><a href=""></a>  <span class="fu">data.frame</span>(</span>
<span id="cb4-8"><a href=""></a>    <span class="at">Mark =</span> <span class="fu">rbinom</span>(n, <span class="dv">100</span>, <span class="fl">0.6</span>), </span>
<span id="cb4-9"><a href=""></a>    <span class="at">Group =</span> <span class="fu">c</span>(<span class="st">'üê¨'</span>, <span class="st">'üê™'</span>) <span class="sc">|&gt;</span> <span class="fu">sample</span>(n, <span class="at">replace =</span> <span class="cn">TRUE</span>), </span>
<span id="cb4-10"><a href=""></a>    <span class="at">Height =</span> <span class="fu">rnorm</span>(n, <span class="fl">1.67</span>, <span class="fl">0.1</span>) <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">2</span>)</span>
<span id="cb4-11"><a href=""></a>  )</span>
<span id="cb4-12"><a href=""></a>}) <span class="sc">|&gt;</span> <span class="fu">setNames</span>(students) <span class="sc">|&gt;</span> <span class="co"># Give the data frames names</span></span>
<span id="cb4-13"><a href=""></a>  openxlsx<span class="sc">::</span><span class="fu">write.xlsx</span>(<span class="st">'gen_data_3.xlsx'</span>, </span>
<span id="cb4-14"><a href=""></a>        <span class="at">firstRow =</span> <span class="cn">TRUE</span>, <span class="at">asTable =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-15"><a href=""></a>        <span class="at">colWidths =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>) <span class="co"># or "auto"</span></span>
<span id="cb4-16"><a href=""></a>     ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="gen_data_3.png" class="quarto-figure quarto-figure-center r-stretch" width="316"></section>
<section id="sidenote-to-the-sidenote" class="slide level2 smaller">
<h2>Sidenote to the sidenote</h2>
<blockquote>
<p>When you introduce R to people who haven‚Äôt used it before, where do you start?</p>
</blockquote>
<ul>
<li>I always start in RStudio, with File -&gt; New File -&gt; Quarto Document (or R Markdown)
<ul>
<li>Just like with R Projects, RStudio will always and automatically set the working directory for you</li>
<li>I do not waste an hour trying to explain working directories, I just tell students to put the data in the same folder as the .qmd or .Rmd file
<ul>
<li>Relative referencing beats absolute referencing 99% of the time</li>
</ul></li>
<li>Forces some structure
<ul>
<li>Encourages documentation and other good practices</li>
</ul></li>
<li>Increases alignment between code and results</li>
</ul></li>
</ul>
</section>
<section id="parameterised-documents" class="slide level2 smaller">
<h2>Parameterised documents</h2>
<p>At the start of each Quarto document is a YAML block. The only line that‚Äôs compulsory is the <em>output</em> line that says what format we want, e.g.&nbsp;Word, PDF, PowerPoint, Beamer, revealjs, <em>etc.</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href=""></a><span class="sc">---</span></span>
<span id="cb5-2"><a href=""></a>title<span class="sc">:</span> <span class="st">"Statistics assignment memorandum"</span></span>
<span id="cb5-3"><a href=""></a>author<span class="sc">:</span> <span class="st">"Sean van der Merwe"</span></span>
<span id="cb5-4"><a href=""></a>date<span class="sc">:</span> <span class="st">"`r format(Sys.Date(), '%Y-%m-%d')`"</span></span>
<span id="cb5-5"><a href=""></a>output<span class="sc">:</span></span>
<span id="cb5-6"><a href=""></a>  word_document<span class="sc">:</span></span>
<span id="cb5-7"><a href=""></a>    reference_docx<span class="sc">:</span> wordreference01.docx</span>
<span id="cb5-8"><a href=""></a>params<span class="sc">:</span> </span>
<span id="cb5-9"><a href=""></a>  st<span class="sc">:</span> <span class="st">"2123456789"</span></span>
<span id="cb5-10"><a href=""></a><span class="sc">---</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>If we include parameters in the YAML then we can access them in the code, e.g.&nbsp;<em>params$st</em></li>
<li>We can set the parameter values via the ‚Äúexecute_params‚Äù input in the <em>quarto::quarto_render</em> function
<ul>
<li>You can have a separate script that renders the document for each student, in a loop
<ul>
<li>and even emails it to each student if you have the right permissions</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="reference-documents" class="slide level2">
<h2>Reference documents</h2>
<ul>
<li>For Word and PowerPoint you can create a special formatting document called a reference document</li>
<li>You do this by making a new Quarto document of the target type and rendering it without changing anything
<ul>
<li>The content of this document is irrelevant so don‚Äôt change it</li>
</ul></li>
<li>In Word/PowerPoint, you modify the <strong>styles</strong> of the document, as well as settings like margins, paper size, header/footer, and language</li>
<li>For future documents you copy the reference document in the same folder and the new document and reference it in the YAML</li>
<li>The result is then that you new document renders in the desired style and settings</li>
</ul>
</section></section>
<section>
<section id="conclusion-to-part-2" class="title-slide slide level1 center">
<h1>Conclusion to Part 2</h1>
<ul>
<li>Don‚Äôt be flashy for the sake of being flashy (<em>e.g.&nbsp;slow slide transitions</em>)
<ul>
<li>You‚Äôre going to just annoy yourself and distract the audience</li>
</ul></li>
<li>Think of your audience, the message you‚Äôre trying to convey, and then ask, <strong>‚ÄúHow can presentation technology support me in transferring information to my audience?‚Äù</strong></li>
</ul>
<blockquote>
<p>This presentation was created using the Reveal.js format in <a href="https://quarto.org/">Quarto</a>, using the <a href="https://posit.co/products/open-source/rstudio/">RStudio IDE</a>. Background image created using image editor <a href="https://www.gimp.org/">GIMP</a> by compositing images from CoPilot.</p>
</blockquote>
</section>
<section id="if-youre-eager-to-start-part-3" class="slide level2">
<h2>If you‚Äôre eager to start Part 3</h2>
<p>Try to create a basic Quarto document and render it.</p>

<img data-src="NewQuarto.png" class="quarto-figure quarto-figure-center r-stretch" width="270"><ul>
<li>Type a title, your name, and select a format</li>
<li>Find the ‚ÄúRender‚Äù button and click it (blue right arrow near the top with the word ‚ÄúRender‚Äù next to it)</li>
</ul>

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="MDAGlogo.png" class="slide-logo"></p>
<div class="footer footer-default">
<p>2025/11/25 - MDAG</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="mdag2025p2_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="mdag2025p2_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="mdag2025p2_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="mdag2025p2_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="mdag2025p2_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="mdag2025p2_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="mdag2025p2_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="mdag2025p2_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="mdag2025p2_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="mdag2025p2_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="mdag2025p2_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // Parallax background image
        parallaxBackgroundImage: 'stats_background.jpg', // e.g. "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'"

        // Parallax background size
        parallaxBackgroundSize: '2304px 1536px', // CSS syntax, e.g. "2100px 900px"

        parallaxBackgroundVertical: 80,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 5.0e-2,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>